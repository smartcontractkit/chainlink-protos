syntax = "proto3";

package node.v1;

import "google/protobuf/timestamp.proto";

option go_package = "github.com/smartcontractkit/chainlink-protos/storage-service/go;storage_service";

// NodeService defines the download-related storage service interface that is used by nodes.
// Workflow nodes will directly connect via gRPC to the storage service to retrieve presigned URLs
// which can be used to download workflow artifacts.
service NodeService {
  // DownloadArtifact streams a file from the storage service in chunks.
  rpc DownloadArtifact(DownloadArtifactRequest) returns (DownloadArtifactResponse);
}

enum ArtifactType {
  ARTIFACT_TYPE_UNSPECIFIED = 0; // Unspecified artifact type
  ARTIFACT_TYPE_BINARY = 1; // Workflow binary artifact
  ARTIFACT_TYPE_CONFIG = 2; // Workflow configuration artifact
}

message DownloadArtifactRequest {
  string id = 1; // ID of the artifact to download
  ArtifactType type = 2; // Type of the artifact to download
}

message DownloadArtifactResponse {
  string url = 1; // The presigned GET URL for downloading
  google.protobuf.Timestamp expiry = 2; // Expiration time of the presigned URL
}
